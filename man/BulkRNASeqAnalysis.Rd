% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/01_BulkRNASeqAnalysis_class.R
\name{BulkRNASeqAnalysis}
\alias{BulkRNASeqAnalysis}
\title{Bulk RNA-seq Analysis Pipeline}
\description{
An R6 class providing a comprehensive pipeline for bulk RNA-seq data analysis.
The class manages data, parameters, tasks, and results throughout the analysis workflow.
}
\details{
The \code{BulkRNASeqAnalysis} class encapsulates the entire RNA-seq analysis workflow,
from raw count processing to differential expression and functional enrichment.
Users can configure analysis parameters, add tasks to a pipeline, and execute
the workflow with consistent logging and error handling.
}
\section{Public Methods}{

\describe{
\item{\code{initialize(output_root = "results")}}{Initialize the analysis engine}
\item{\code{add_task(task_name, func, params = list())}}{Add an analysis task}
\item{\code{run_pipeline(task_names = NULL)}}{Execute the analysis pipeline}
\item{\code{process_counts_matrix(...)}}{Process raw count matrix}
\item{\code{filter_low_expression(...)}}{Filter low-expression genes}
\item{\code{filter_samples(...)}}{Filter samples based on patterns}
\item{\code{prepare_dge_analysis(...)}}{Prepare for differential expression analysis}
\item{\code{perform_qc_visualization(...)}}{Perform quality control visualization}
\item{\code{perform_dge_analysis(...)}}{Perform differential expression analysis}
\item{\code{generate_volcano_plots(...)}}{Generate volcano plots}
\item{\code{perform_gsea_analysis(...)}}{Perform GSEA analysis}
\item{\code{perform_go_kegg_enrichment(...)}}{Perform GO/KEGG enrichment}
\item{\code{perform_MAplot(...)}}{Generate MA plots}
}
}

\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{counts}}{Raw count matrix}

\item{\code{meta_data}}{Sample metadata}

\item{\code{dds}}{DESeq2 dataset object}

\item{\code{results}}{List of analysis results}

\item{\code{params}}{List of analysis parameters}

\item{\code{tasks}}{List of analysis tasks}

\item{\code{normalized_counts}}{Normalized count matrix}

\item{\code{task_functions}}{task function}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-BulkRNASeqAnalysis-new}{\code{BulkRNASeqAnalysis$new()}}
\item \href{#method-BulkRNASeqAnalysis-add_task}{\code{BulkRNASeqAnalysis$add_task()}}
\item \href{#method-BulkRNASeqAnalysis-run_pipeline}{\code{BulkRNASeqAnalysis$run_pipeline()}}
\item \href{#method-BulkRNASeqAnalysis-process_counts_matrix}{\code{BulkRNASeqAnalysis$process_counts_matrix()}}
\item \href{#method-BulkRNASeqAnalysis-filter_low_expression}{\code{BulkRNASeqAnalysis$filter_low_expression()}}
\item \href{#method-BulkRNASeqAnalysis-filter_samples}{\code{BulkRNASeqAnalysis$filter_samples()}}
\item \href{#method-BulkRNASeqAnalysis-prepare_dge_analysis}{\code{BulkRNASeqAnalysis$prepare_dge_analysis()}}
\item \href{#method-BulkRNASeqAnalysis-perform_qc_visualization}{\code{BulkRNASeqAnalysis$perform_qc_visualization()}}
\item \href{#method-BulkRNASeqAnalysis-perform_dge_analysis}{\code{BulkRNASeqAnalysis$perform_dge_analysis()}}
\item \href{#method-BulkRNASeqAnalysis-generate_volcano_plots}{\code{BulkRNASeqAnalysis$generate_volcano_plots()}}
\item \href{#method-BulkRNASeqAnalysis-perform_gsea_analysis}{\code{BulkRNASeqAnalysis$perform_gsea_analysis()}}
\item \href{#method-BulkRNASeqAnalysis-perform_go_kegg_enrichment}{\code{BulkRNASeqAnalysis$perform_go_kegg_enrichment()}}
\item \href{#method-BulkRNASeqAnalysis-perform_MAplot}{\code{BulkRNASeqAnalysis$perform_MAplot()}}
\item \href{#method-BulkRNASeqAnalysis-clone}{\code{BulkRNASeqAnalysis$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-new"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-new}{}}}
\subsection{Method \code{new()}}{
Initialize a new BulkRNASeqAnalysis object
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$new(output_root = "results")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{output_root}}{Root directory for analysis outputs (default: "results")}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-add_task"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-add_task}{}}}
\subsection{Method \code{add_task()}}{
Add an analysis task to the pipeline
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$add_task(task_name, func, params = list())}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{task_name}}{Unique name for the task}

\item{\code{func}}{Task function to execute}

\item{\code{params}}{List of parameters for the task}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-run_pipeline"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-run_pipeline}{}}}
\subsection{Method \code{run_pipeline()}}{
Execute the analysis pipeline
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$run_pipeline(task_names = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{task_names}}{Optional vector of task names to run (default: all tasks)
Process RNA-seq Count Matrix}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-process_counts_matrix"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-process_counts_matrix}{}}}
\subsection{Method \code{process_counts_matrix()}}{
Load and preprocess raw count matrix, including gene ID conversion and
sample name cleaning.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$process_counts_matrix(
  counts_path = "data/raw_counts.txt",
  gene_mapping_path = "data/gene_mapping.txt",
  output_dir = "00_data",
  expected_cols = c("Chr", "Start", "End", "Strand", "Length"),
  suffix_pattern = "_sorted\\\\.bam$"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{counts_path}}{Path to raw count file}

\item{\code{gene_mapping_path}}{Path to gene ID mapping file}

\item{\code{output_dir}}{Output directory for processed data}

\item{\code{expected_cols}}{Expected columns in count matrix}

\item{\code{suffix_pattern}}{Pattern to remove from sample names}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Processed count matrix
质控过滤
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-filter_low_expression"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-filter_low_expression}{}}}
\subsection{Method \code{filter_low_expression()}}{
过滤低表达基因
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$filter_low_expression(
  min_count = 10,
  min_samples = 3,
  output_dir = "00_data"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{min_count}}{最小计数阈值}

\item{\code{min_samples}}{最小样本数阈值}

\item{\code{output_dir}}{输出目录
样本筛选}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-filter_samples"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-filter_samples}{}}}
\subsection{Method \code{filter_samples()}}{
根据样本命名规则筛选样本
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$filter_samples(
  sample_pattern = ".*",
  exclude_pattern = NULL,
  output_dir = "00_data"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{sample_pattern}}{样本名匹配模式}

\item{\code{exclude_pattern}}{排除样本模式}

\item{\code{output_dir}}{输出目录
准备差异分析数据}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-prepare_dge_analysis"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-prepare_dge_analysis}{}}}
\subsection{Method \code{prepare_dge_analysis()}}{
创建样本元数据并准备DESeq2输入
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$prepare_dge_analysis(
  ctrl_pattern = "C",
  split_pattern = "",
  paired = FALSE,
  output_dir = "02_DEG"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{ctrl_pattern}}{对照组的特征}

\item{\code{split_pattern}}{命名中的分隔符号}

\item{\code{paired}}{是否为成对（逻辑值）}

\item{\code{output_dir}}{输出目录
数据质控可视化}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-perform_qc_visualization"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-perform_qc_visualization}{}}}
\subsection{Method \code{perform_qc_visualization()}}{
执行数据质控并生成可视化报告
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$perform_qc_visualization(output_dir = "01_check")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{output_dir}}{输出目录
执行差异表达分析}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-perform_dge_analysis"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-perform_dge_analysis}{}}}
\subsection{Method \code{perform_dge_analysis()}}{
使用DESeq2进行差异表达分析
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$perform_dge_analysis(
  reference = "Ctrl",
  alpha = 0.05,
  fc = 0.5,
  output_dir = "02_DEG"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{reference}}{指定对照}

\item{\code{alpha}}{矫正p值阈值}

\item{\code{fc}}{差异倍数阈值}

\item{\code{output_dir}}{输出目录
绘制火山图}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-generate_volcano_plots"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-generate_volcano_plots}{}}}
\subsection{Method \code{generate_volcano_plots()}}{
为每个比较组绘制差异表达火山图
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$generate_volcano_plots(
  dge_dir = "02_DEG",
  alpha = 0.05,
  fc = 0.5,
  output_dir = "02_DEG"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{dge_dir}}{差异分析结果目录}

\item{\code{alpha}}{padj阈值}

\item{\code{fc}}{logfc阈值}

\item{\code{output_dir}}{输出目录
执行GSEA分析}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-perform_gsea_analysis"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-perform_gsea_analysis}{}}}
\subsection{Method \code{perform_gsea_analysis()}}{
对差异表达结果进行基因集富集分析
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$perform_gsea_analysis(
  dge_dir = "02_DEG",
  pathway_db = "db/selected_pathway.xlsx",
  species = "Homo sapiens",
  gs_cat = "C5",
  pvaluecut = 0.25,
  gs_subcat = NULL,
  output_dir = "03_Enrichment"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{dge_dir}}{差异分析结果目录}

\item{\code{pathway_db}}{自选通路数据库路径}

\item{\code{species}}{物种}

\item{\code{gs_cat}}{条目分类}

\item{\code{pvaluecut}}{gsea的阈值}

\item{\code{gs_subcat}}{条目亚分类
执行GO和KEGG富集分析}

\item{\code{output_dir}}{输出目录}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-perform_go_kegg_enrichment"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-perform_go_kegg_enrichment}{}}}
\subsection{Method \code{perform_go_kegg_enrichment()}}{
对差异表达结果进行基因本体论(GO)和KEGG通路富集分析
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$perform_go_kegg_enrichment(
  dge_dir = "02_DEG",
  alpha = 0.05,
  fc = 1,
  reference = "Ctrl",
  dge_file = "dge_results.csv",
  qv = 0.05,
  organism = "hsa",
  OrgDb = "org.Hs.eg.db",
  ont = "BP"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{dge_dir}}{差异分析结果目录}

\item{\code{alpha}}{显著性阈值（调整后p值）}

\item{\code{fc}}{差异表达倍数变化阈值（绝对值log2FC）}

\item{\code{reference}}{参考组名称}

\item{\code{dge_file}}{差异分析结果文件名}

\item{\code{qv}}{富集分析q值阈值}

\item{\code{organism}}{KEGG物种缩写}

\item{\code{OrgDb}}{OrgDb数据库对象}

\item{\code{ont}}{GO子本体论类型
Generate MA Plots}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-perform_MAplot"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-perform_MAplot}{}}}
\subsection{Method \code{perform_MAplot()}}{
Create MA plots for each comparison group showing log fold change vs mean expression.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$perform_MAplot(output_dir = "02_DEG")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{output_dir}}{Output directory for plots}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
List of plot file paths
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-BulkRNASeqAnalysis-clone"></a>}}
\if{latex}{\out{\hypertarget{method-BulkRNASeqAnalysis-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{BulkRNASeqAnalysis$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
